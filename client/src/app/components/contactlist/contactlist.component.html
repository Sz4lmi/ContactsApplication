<div class="contact-list-container">
  <h2>Contact List</h2>

  <!-- List of contact cards -->
  <div class="contact-list">
    <div *ngFor="let contact of contacts" class="contact-card">
      <div class="contact-info">
        <h3>{{ contact.firstName }} {{ contact.lastName }}</h3>
        <div *ngIf="contact.addresses && contact.addresses.length > 0" class="address-info">
          <p>{{ contact.addresses[0].street }}, {{ contact.addresses[0].zipCode }} {{ contact.addresses[0].city }}</p>
          <p *ngIf="contact.addresses.length > 1" class="additional-info">+{{ contact.addresses.length - 1 }} more addresses</p>
        </div>
        <div *ngIf="!contact.addresses || contact.addresses.length === 0" class="address-info">
          <p class="no-address">No address information</p>
        </div>
      </div>
      <div class="contact-actions">
        <button class="edit-button" (click)="openEditModal(contact)">Edit</button>
        <button class="delete-button" (click)="deleteContact(contact)">Delete</button>
      </div>
    </div>

    <div *ngIf="contacts.length === 0" class="no-contacts">
      <p>No contacts found. Add some contacts to see them here.</p>
    </div>
  </div>
</div>

<!-- Edit Contact Modal -->
<div *ngIf="showEditModal" class="modal-overlay">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Edit Contact</h2>
      <button type="button" class="close-button" (click)="closeEditModal()">Ã—</button>
    </div>

    <form [formGroup]="editContactForm" (ngSubmit)="updateContact()">
      <!-- Personal Information -->
      <div class="form-section">
        <h3>Personal Information</h3>
        <div class="form-row">
          <div class="form-field">
            <label for="firstName">First Name</label>
            <input id="firstName" formControlName="firstName" required>
          </div>
          <div class="form-field">
            <label for="lastName">Last Name</label>
            <input id="lastName" formControlName="lastName" required>
          </div>
        </div>
        <div class="form-field">
          <label for="email">Email</label>
          <input id="email" formControlName="email" type="email">
        </div>
        <div class="form-field">
          <label for="birthDate">Birth Date</label>
          <input id="birthDate" formControlName="birthDate" type="date">
        </div>
        <div class="form-field">
          <label for="mothersName">Mother's Name</label>
          <input id="mothersName" formControlName="mothersName">
        </div>
      </div>

      <!-- Identification  -->
      <div class="form-section">
        <h3>Identification</h3>
        <div class="form-row">
          <div class="form-field">
            <label for="tajNumber">TAJ Number</label>
            <input id="tajNumber" formControlName="tajNumber">
          </div>
          <div class="form-field">
            <label for="taxId">Tax ID</label>
            <input id="taxId" formControlName="taxId">
          </div>
        </div>
      </div>

      <!-- Contact Information -->
      <div class="form-section">
        <h3>Contact Information</h3>

        <!-- Phone Numbers -->
        <div class="array-field" formArrayName="phoneNumbers">
          <div class="array-field-header">
            <h4>Phone Numbers</h4>
            <button type="button" class="add-button" (click)="addPhoneNumber()">Add Phone Number</button>
          </div>
          <div class="array-item" *ngFor="let phone of phoneNumbers.controls; let i = index">
            <input [formControlName]="i" placeholder="Phone Number">
            <button type="button" class="remove-button" (click)="removePhoneNumber(i)">Remove</button>
          </div>
          <div *ngIf="phoneNumbers.controls.length === 0" class="array-item">
            <p>No phone numbers added yet. Click "Add Phone Number" to add one.</p>
          </div>
        </div>

        <!-- Addresses -->
        <div class="array-field" formArrayName="addresses">
          <div class="array-field-header">
            <h4>Addresses</h4>
            <button type="button" class="add-button" (click)="addAddress()">Add Address</button>
          </div>
          <div *ngFor="let address of addresses.controls; let i = index" [formGroupName]="i" class="address-fields">
            <input formControlName="street" placeholder="Street" required>
            <input formControlName="city" placeholder="City" required>
            <input formControlName="zipCode" placeholder="Zip Code" required>
            <button type="button" class="remove-button" (click)="removeAddress(i)">Remove</button>
          </div>
          <div *ngIf="addresses.controls.length === 0" class="array-item">
            <p>No addresses added yet. Click "Add Address" to add one.</p>
          </div>
        </div>
      </div>

      <!-- Submit Button -->
      <div class="modal-footer">
        <button type="button" class="cancel-button" (click)="closeEditModal()">Cancel</button>
        <button type="submit" [disabled]="editContactForm.invalid">Update Contact</button>
      </div>
    </form>
  </div>
</div>
